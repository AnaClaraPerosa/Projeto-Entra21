{% extends 'basesubp2.html' %}
{% load static %}

{%  block content %}

    <!-- Breadcrumb Section Begin -->
    <section class="breadcrumb-section set-bg" data-setbg="{% static 'img/breadcrumb.jpg' %}">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 text-center">
                    <div class="breadcrumb__text">
                        <h2>Carrinho de Compras</h2>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Breadcrumb Section End -->

    <!-- Shoping Cart Section Begin -->
    {% if carrinho %}
        <section class="shoping-cart spad">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="shoping__cart__table">
                            <table>
                                <thead>
                                    <tr>
                                        <th class="shoping__product">Produtos</th>
                                        <th>Quantidade</th>
                                        <th>Preço</th>
                                        <!-- <th>Total</th> -->
                                        <th>Remover</th>
                                    </tr>
                                </thead>

                                <tbody>
                                    {% for item in carrinho %}
                                        <tr>
                                            <td class="shoping__cart__item">
                                                <img src="{{ item.produto.get_thumbnail }}" alt="" height="100" width="130">
                                                <h5><a href="{% url 'produto' item.produto.categoria.slug item.produto.slug %}">{{ item.produto.titulo }}</a></h5>
                                            </td>

                                            <td class="shoping__cart__quantity">
                                                <a href="?muda_quantidade={{ item.id }}&quantidade=-1" ><i class="fa fa-minus-circle"></i></a>
                                                {{ item.quantidade }}
                                                <a href="?muda_quantidade={{ item.id }}&quantidade=1"><i class="fa fa-plus-circle"></i></a>
                                            </td>

                                            <td class="shoping__cart__total">R${{ item.preco_total }}</td>
                                            <td><a href="?remove_do_carrinho={{ item.id }}" class="delete"><i class="fa fa-trash"></i></a></td>

                                        </tr>
                                   {% endfor %} 

                                </tbody>
                            </table>  
                        </div>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-lg-12">
                        <div class="shoping__cart__btns">
                            <a href="{% url 'loja' %}" class="primary-btn cart-btn">CONTINUE COMPRANDO</a>
                        </div>
                    </div>


                    <div class="col-lg-6">
                        <div class="shoping__checkout">
                            <h5>Total do Carrinho</h5>
                            <ul>
                                <!-- <li>Subtotal <span>R$91.00</span></li> -->
                                <li><span>{{ carrinho | length }} Itens</span></li>
                                <li><strong>R${{ carrinho.get_custo_total }}</strong></li>
                            </ul>
                            <a href="#" class="primary-btn">FINALIZAR COMPRAS</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
     <!-- Shoping Cart Section End -->

        <h2 class="subtitle">Informações de contato</h2>

        <form method="post" action="." id="payment-form">
            {% csrf_token %}

            {% if form.non_field_errors %}
                <div class="notification is-danger">
                    {{ form.non_field_errors }}
                </div>
            {% endif %}

            {% if form.errors %}
                <div class="notification is-danger">
                    <ul>
                        {% for field in form %}
                            {% for error in field.errors %}
                                <li><strong>{{ field.label }}: </strong>{{ error }}</li>
                            {% endfor %}
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}
    
            <div class="columns">
                <div class="column is-6">
                    <div class="field">
                        <label>Nome</label>

                        <div class="control">
                            <input class="input" type="text" name="primeiro_nome">
                        </div>
                    </div>

                    <div class="field">
                        <label>Sobrenome</label>

                        <div class="control">
                            <input class="input" type="text" name="sobrenome">
                        </div>
                    </div>
                    
                    <div class="field">
                        <label>E-mail</label>

                        <div class="control">
                            <input class="input" type="email" name="email">
                        </div>
                    </div>

                    <div class="field">
                        <label>Telefone</label>

                        <div class="control">
                            <input class="input" type="text" name="telefone">
                        </div>
                    </div>
                </div>

                <div class="column is-6">
                    <div class="field">
                        <label>Endereço</label>

                        <div class="control">
                            <input class="input" type="text" name="endereco">
                        </div>
                    </div>

                    <div class="field">
                        <label>CEP</label>

                        <div class="control">
                            <input class="input" type="text" name="cep">
                        </div>
                    </div>

                    <div class="field">
                        <label>Cidade</label>

                        <div class="control">
                            <input class="input" type="text" name="cidade">
                        </div>
                    </div>
                </div>
            </div>

            {% if messages %}
                {% for message in messages %}
                    <div class="notification is-danger">{{ message }}</div>
                {% endfor %}
            {% endif %}

            <div class="field">
                <div class="control">
                    <button class="button is-dark mt-4 is-uppercase">Enviar</button>
                </div>
            </div>
        </div>

    {% else %}
        <p>Você não tem produtos no seu carrinho</p>
    {% endif %}

{% endblock %}
